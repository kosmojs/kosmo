import { createRouter, createWebHistory, createMemoryHistory } from "vue-router";

import { routes } from "{{importPathmap.vue}}";
import { baseurl } from "./config";

{{! INFO: HMR broken if default export is an anonymous function }}
export default async function AppRouter(ssrProps?: { url: string }) {
  const router = createRouter({
    history: ssrProps ? createMemoryHistory(baseurl) : createWebHistory(baseurl),
    routes,
  });

  if (ssrProps?.url) {
    await router.push(ssrProps.url.replace(baseurl, ""));
    await router.isReady();
  }

  return router;
}
