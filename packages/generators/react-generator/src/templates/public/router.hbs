import {
  createBrowserRouter,
  createStaticRouter,
  Outlet,
  RouterProvider,
  StaticRouterProvider,
} from "react-router";

import { routes } from "{{importPathmap.react}}";

import App from "./App";
import { baseurl } from "./config";

export const routeStack = [
  {
    path: "/",
    element: (
      <App>
        <Outlet />
      </App>
    ),
    HydrateFallback: () => <div>Loading...</div>,
    children: routes,
  },
];

{{! INFO: HMR broken if default export is an anonymous function }}
export default function AppRouter(ssrProps?: { context?: never }) {
  if (ssrProps?.context) {
    const router = createStaticRouter(routeStack, ssrProps.context);
    return <StaticRouterProvider router={router} context={ssrProps.context} />;
  }
  const router = createBrowserRouter(routeStack, { basename: baseurl });
  return <RouterProvider router={router} />;
}

